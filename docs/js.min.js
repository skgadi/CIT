function getNumFromText(e){var a;try{return a=math.evaluate(e),math.isNumeric(a)?a:NaN}catch(e){return NaN}}function getColorAt(e){return listOfColors[e%listOfColors.length]}function updateMathJax(){MathJax.Hub.Queue(["Typeset",MathJax.Hub])}var lang={en:{name:"English",appName:"CIT",appFName:"Control and Identification Toolbox",algorithms:{sResponse:{name:"System response",documentation:"ol-system.pdf",plots:{u:"Input to the system, $u(t)$",y:"System output, $y(t)$"},fGens:{u:{name:"Input to the system, $u(t)$"}},inputs:{in:"System output, $y(t)$"},outputs:{out:"System input, $u(t)$"}},pid:{name:"PID controller",documentation:"pid.pdf",params:{"k-p":{name:"Proportional constant, $K_P$",dValue:10,min:-1/0,max:1/0},"k-i":{name:"Integral constant, $K_I$",dValue:1,min:-1/0,max:1/0},"k-d":{name:"Derivative constant, $K_D$",dValue:0,min:-1/0,max:1/0}},plots:{r:"Reference, $r(t)$",y:"System output, $y(t)$",e:"Error, $e(t)$",u:"Control signal, $u(t)$"},fGens:{u:{name:"Reference, $r(t)$"}},inputs:{in:"System output, $y(t)$"},outputs:{out:"Control signal, $u(t)$"}}},mTabs:{mModel:"Mathematical model",bridgeDevice:"Bridge device configuration",params:"Simulation parameters",fGens:"Function generator(s)",graphs:"Graphs",errors:"Errors"},bridge:{iTypeName:"Input type",iTypes:{analog:"Analog voltage",encoder:"Encoder",temp:"Temperature sensor",humidity:"Humidity sensor",current:"Aanalog current",light:"Light sensor"},oTypeName:"Output type",oTypes:{dc0:"Pulsed DC voltage out Ch00",dc1:"Pulsed DC voltage out Ch01",ac0:"Pulsed AC voltage out Ch00",ac1:"Pulsed AC voltage out Ch01"}},offset:"Offset",gain:"Gain",aSelection:"Algorithm selection",noParams:"Parameters are unavailable for the selected algorithm.",fGens:{params:{amp:{name:"Amplitude",val:1,min:0,max:1/0},freq:{name:"Frequency",val:1,min:0,max:1/0},duty:{name:"Duty  cycle",val:50,min:0,max:100},phase:{name:"Phase",val:0,min:-360,max:360},offset:{name:"Offset",val:0,min:-1/0,max:1/0},start:{name:"Start at",val:0,min:0,max:1/0}},iSignal:"Invert signal",sTypes:{step:{name:"Step function",params:["amp","offset"]},sine:{name:"Sine wave",params:["amp","freq","phase","offset"]},triangle:{name:"Triangular wave",params:["amp","freq","phase","offset"]},sawtooth:{name:"Sawtooth wave",params:["amp","freq","phase","offset"]},rect:{name:"Rectangular wave",params:["amp","freq","phase","duty","offset"]}},sType:"Signal type"},errors:{uENFound:"No error found in the data entered by user.",uEFound:"Error: following values entered by the user are wrong.",sec:"Section",sSec:"Subsection",uVal:"Value entered",min:"Minimum",max:"Maximum"},plots:{show:"Show in graph",nWind:"Open in new window",sLog:"Download the log",sComplex:"Plot the complex numbers",sDAll:"Select/Deselect all"},sim:{name:"Simulation",run:"Run",stop:"Stop",ts:"Sampling time, $T_S$",tPeriod:"Execution time, $T$"}},es:{name:"Español",appName:"CIT",appFName:"Caja de herramientas de control e identificación",algorithms:{sResponse:{name:"Respuesta del sistema",documentation:"ol-system.pdf",plots:{u:"Entrada al sistema, $u(t)$",y:"Salida del sistema, $y(t)$"},fGens:{u:{name:"Entrada al sistema, $u(t)$"}},inputs:{in:"Salida del sistema, $y(t)$"},outputs:{out:"Entrada del sistema, $u(t)$"}},pid:{name:"Controlador PID",documentation:"pid.pdf",params:{"k-p":{name:"Constante proporcional, $K_P$",dValue:10,min:-1/0,max:1/0},"k-i":{name:"Constante integral, $K_I$",dValue:1,min:-1/0,max:1/0},"k-d":{name:"Constante derivada, $K_D$",dValue:0,min:-1/0,max:1/0}},plots:{r:"Referencia, $r(t)$",y:"Salida del sistema, $y(t)$",e:"Error, $e(t)$",u:"Siñal de control, $u(t)$"},fGens:{u:{name:"Referencia, $r(t)$"}},inputs:{in:"Salida del sistema, $y(t)$"},outputs:{out:"Siñal de control, $u(t)$"}}},mTabs:{mModel:"Modelo matemático",bridgeDevice:"Configuración del dispositivo puente",params:"Parámetros de simulación",fGens:"Generador(es) de funciones",graphs:"Gráficos",errors:"Errores"},bridge:{iTypeName:"Tipo de entrada",iTypes:{analog:"Voltaje análogo",encoder:"Codificador",temp:"Sensor de temperatura",humidity:"Sensor de humedad",current:"Aanalog actual",light:"Sensor de luz"},oTypeName:"Tipo de salida",oTypes:{dc0:"Saluda de tensión DC pulsada Ch00",dc1:"Saluda de tensión DC pulsada Ch01",ac0:"Saluda de tensión AC pulsada Ch00",ac1:"Saluda de tensión AC pulsada Ch01"}},offset:"Offset",gain:"Ganancia",aSelection:"Selección de algoritmo",noParams:"Los parámetros no están disponibles para el algoritmo seleccionado.",fGens:{params:{amp:{name:"Amplitude",val:1,min:0,max:1/0},freq:{name:"Frequency",val:1,min:0,max:1/0},duty:{name:"Duty  cycle",val:50,min:0,max:100},phase:{name:"Fase",val:0,min:-360,max:360},offset:{name:"Offset",val:0,min:-1/0,max:1/0},start:{name:"Start at",val:0,min:0,max:1/0}},iSignal:"Invert signal",sTypes:{step:{name:"Step function",params:["amp","offset"]},sine:{name:"Sine wave",params:["amp","freq","phase","offset"]},triangle:{name:"Triangular wave",params:["amp","freq","phase","offset"]},sawtooth:{name:"Sawtooth wave",params:["amp","freq","phase","offset"]},rect:{name:"Rectangular wave",params:["amp","freq","phase","duty","offset"]}},sType:"Signal type"},errors:{uENFound:"No se encontraron errores en los datos ingresados por el usuario.",uEFound:"Error: los siguientes valores ingresados por el usuario son incorrectos.",sec:"Sección",sSec:"Subsección",uVal:"Valor ingresado",min:"Mínimo",max:"Máximo"},plots:{show:"Mostrar en gráfico",nWind:"Abrir en nueva ventana",sLog:"Descargar el registro",sComplex:"Graficar los números complejos",sDAll:"Seleccionar / Deseleccionar todo"},sim:{name:"Simulación",run:"Ejecutar",stop:"Detener",ts:"Tiempo de muestreo, $T_S$",tPeriod:"Tiempo de ejecución, $T$"}}};String.prototype.replaceAll_1=function(e,a){var t=this;return t.replace(new RegExp(e,"g"),a)},String.prototype.replaceAll_2=function(e,a){var t=this;return t.split(e).join(a)};const listOfColors=["#8c0000","#ffbf40","#33ccc2","#3d00e6","#330014","#ffbfbf","#8c8846","#13414d","#110040","#f23d6d","#8c5946","#bfff40","#79caf2","#9286b3","#4d393c","#ff6600","#008c38","#004b8c","#8c2385","#332200","#698c7c","#8091ff","#ff80f6"],listOfColors1=["#63b598","#ce7d78","#ea9e70","#a48a9e","#c6e1e8","#648177","#0d5ac1","#f205e6","#1c0365","#14a9ad","#4ca2f9","#a4e43f","#d298e2","#6119d0","#d2737d","#c0a43c","#f2510e","#651be6","#79806e","#61da5e","#cd2f00","#9348af","#01ac53","#c5a4fb","#996635","#b11573","#4bb473","#75d89e","#2f3f94","#2f7b99","#da967d","#34891f","#b0d87b","#ca4751","#7e50a8","#c4d647","#e0eeb8","#11dec1","#289812","#566ca0","#ffdbe1","#2f1179","#935b6d","#916988","#513d98","#aead3a","#9e6d71","#4b5bdc","#0cd36d","#250662","#cb5bea","#228916","#ac3e1b","#df514a","#539397","#880977","#f697c1","#ba96ce","#679c9d","#c6c42c","#5d2c52","#48b41b","#e1cf3b","#5be4f0","#57c4d8","#a4d17a","#225b8","#be608b","#96b00c","#088baf","#f158bf","#e145ba","#ee91e3","#05d371","#5426e0","#4834d0","#802234","#6749e8","#0971f0","#8fb413","#b2b4f0","#c3c89d","#c9a941","#41d158","#fb21a3","#51aed9","#5bb32d","#807fb","#21538e","#89d534","#d36647","#7fb411","#0023b8","#3b8c2a","#986b53","#f50422","#983f7a","#ea24a3","#79352c","#521250","#c79ed2","#d6dd92","#e33e52","#b2be57","#fa06ec","#1bb699","#6b2e5f","#64820f","#1c271","#21538e","#89d534","#d36647","#7fb411","#0023b8","#3b8c2a","#986b53","#f50422","#983f7a","#ea24a3","#79352c","#521250","#c79ed2","#d6dd92","#e33e52","#b2be57","#fa06ec","#1bb699","#6b2e5f","#64820f","#1c271","#9cb64a","#996c48","#9ab9b7","#06e052","#e3a481","#0eb621","#fc458e","#b2db15","#aa226d","#792ed8","#73872a","#520d3a","#cefcb8","#a5b3d9","#7d1d85","#c4fd57","#f1ae16","#8fe22a","#ef6e3c","#243eeb","#1dc18","#dd93fd","#3f8473","#e7dbce","#421f79","#7a3d93","#635f6d","#93f2d7","#9b5c2a","#15b9ee","#0f5997","#409188","#911e20","#1350ce","#10e5b1","#fff4d7","#cb2582","#ce00be","#32d5d6","#17232","#608572","#c79bc2","#00f87c","#77772a","#6995ba","#fc6b57","#f07815","#8fd883","#060e27","#96e591","#21d52e","#d00043","#b47162","#1ec227","#4f0f6f","#1d1d58","#947002","#bde052","#e08c56","#28fcfd","#bb09b","#36486a","#d02e29","#1ae6db","#3e464c","#a84a8f","#911e7e","#3f16d9","#0f525f","#ac7c0a","#b4c086","#c9d730","#30cc49","#3d6751","#fb4c03","#640fc1","#62c03e","#d3493a","#88aa0b","#406df9","#615af0","#4be47","#2a3434","#4a543f","#79bca0","#a8b8d4","#00efd4","#7ad236","#7260d8","#1deaa7","#06f43a","#823c59","#e3d94c","#dc1c06","#f53b2a","#b46238","#2dfff6","#a82b89","#1a8011","#436a9f","#1a806a","#4cf09d","#c188a2","#67eb4b","#b308d3","#fc7e41","#af3101","#ff065","#71b1f4","#a2f8a5","#e23dd0","#d3486d","#00f7f9","#474893","#3cec35","#1c65cb","#5d1d0c","#2d7d2a","#ff3420","#5cdd87","#a259a4","#e4ac44","#1bede6","#8798a4","#d7790f","#b2c24f","#de73c2","#d70a9c","#25b67","#88e9b8","#c2b0e2","#86e98f","#ae90e2","#1a806b","#436a9e","#0ec0ff","#f812b3","#b17fc9","#8d6c2f","#d3277a","#2ca1ae","#9685eb","#8a96c6","#dba2e6","#76fc1b","#608fa4","#20f6ba","#07d7f6","#dce77a","#77ecca"];var app=new Vue({el:"#app",data:{lang:lang,sLang:"en",sAlgorithm:"",display:{mModel:!0,bridgeDevice:!0,params:!0,fGens:!0,graphs:!0,errors:!0},sInputs:{},iGains:{},iOffsets:{},sOutputs:{},oGains:{},oOffsets:{},params:{},fGens:{},errors:[],plots:{},chart:{uCounter:0},pHeight:500,defaults:{sInputs:"analog",iGains:1,iOffsets:0,sOutputs:"dc0",oGains:1,oOffsets:0},dFGen:{sType:"step",params:{},iSignal:!1},sim:{running:!1,ts:.1,tPeriod:5}},watch:{"chart.uCounter":function(){this.chart.ready&&this.chart.view.draw(this.chart.data,this.chart.options)},"plots.allSelected":function(e,a){for(var t=Object.keys(this.plots.signals),s=0;s<t.length;s++){var n=t[s];this.plots.signals[n].selected=e}setTimeout(()=>{document.getElementById("all_plots_display").indeterminate=!0},1e3)},sAlgorithm:{deep:!0,handler:function(){this.resetPlots(),this.validateInputs()}},sLang:function(){},sim:{deep:!0,handler:function(){this.validateInputs()}},oGains:{deep:!0,handler:function(){this.validateInputs()}},oOffsets:{deep:!0,handler:function(){this.validateInputs()}},iGains:{deep:!0,handler:function(){this.validateInputs()}},iOffsets:{deep:!0,handler:function(){this.validateInputs()}},params:{deep:!0,handler:function(){this.validateInputs()}},fGens:{deep:!0,handler:function(){this.validateInputs()}}},beforeMount:function(){this.$set(this,"sAlgorithm","sResponse")},mounted:function(){document.getElementById("loading").style.display="none",document.getElementById("app").style.display="block"},updated:function(){this.resetInvalidsToDefault(),updateMathJax()},computed:{cLang:function(){return this.lang[this.sLang]},mModel:function(){return`<embed src='https://cit.skgadi.com/m-models/${this.cLang.algorithms[this.sAlgorithm].documentation}' style='width:100%; height:500px; display: block;'/>`}},methods:{updateChartData:function(){},resetChart:function(){this.chart.ready&&(this.chart.data.removeColumns(0,this.chart.data.getNumberOfColumns()),this.chart.data.addColumn("number","Time"));for(var e=this.cLang.algorithms[this.sAlgorithm].plots,a=Object.keys(e),t=0;t<a.length;t++){var s=a[t];this.chart.ready&&this.chart.data.addColumn("number",s)}this.chart.uCounter++},resetPlots:function(){this.$set(this,"plots",{t:[],signals:{},allSelected:!0});for(var e=this.cLang.algorithms[this.sAlgorithm].plots,a=Object.keys(e),t=0;t<a.length;t++){var s=a[t];this.$set(this.plots.signals,s,{name:e[s],log:[],selected:!0,color:getColorAt(t)})}this.resetChart()},gPaletteClick:function(e){document.getElementById("gColor_"+e).click()},addToFGens:function(e,a){this.fGens[e].splice(a,0,JSON.parse(JSON.stringify(this.dFGen))),this.$nextTick(this.validateInputs)},delAFGen:function(e,a){this.fGens[e].splice(a,1),this.$nextTick(this.validateInputs)},clearErrors:function(){this.$set(this,"errors",[])},validateInputs:function(){this.clearErrors();for(var e=document.getElementsByClassName("errValidation"),a=0;a<e.length;a++){var t,s,n,i=e[a],o=!1;t=getNumFromText(i.value),s=math.evaluate(i.getAttribute("min")),n=math.evaluate(i.getAttribute("max")),isNaN(t)?o=!0:math.abs(t)===1/0?o=!0:NaN!==s&&t<s?o=!0:NaN!==n&&t>n&&(o=!0),o?(this.errors.push({mTab:i.getAttribute("mTab"),sID:i.getAttribute("sID"),val:i.value,min:"$"+math.parse(s).toTex().replaceAll_1("Infinity","\\infty")+"$",max:"$"+math.parse(n).toTex().replaceAll_1("Infinity","\\infty")+"$"}),i.classList.add("w3-red")):i.classList.remove("w3-red")}},resetInvalidsToDefault:function(){for(var e=Object.keys(this.cLang.algorithms[this.sAlgorithm].inputs),a=["sInputs","iOffsets","iGains"],t=0;t<e.length;t++)for(var s=e[t],n=0;n<a.length;n++){var i=a[n];if(void 0===this[i][s])return this.$set(this[i],s,this.defaults[i]),void this.$nextTick(this.validateInputs)}e=Object.keys(this.cLang.algorithms[this.sAlgorithm].outputs),a=["sOutputs","oOffsets","oGains"];for(t=0;t<e.length;t++)for(s=e[t],n=0;n<a.length;n++){i=a[n];if(void 0===this[i][s])return this.$set(this[i],s,this.defaults[i]),void this.$nextTick(this.validateInputs)}if(this.cLang.algorithms[this.sAlgorithm].params){e=Object.keys(this.cLang.algorithms[this.sAlgorithm].params);for(t=0;t<e.length;t++){s=e[t];if(void 0===this.params[s])return this.$set(this.params,s,this.cLang.algorithms[this.sAlgorithm].params[s].dValue),void this.$nextTick(this.validateInputs)}}if(this.cLang.algorithms[this.sAlgorithm].fGens){e=Object.keys(this.cLang.algorithms[this.sAlgorithm].fGens);for(t=0;t<e.length;t++){s=e[t];if(void 0===this.fGens[s]||0===this.fGens[s].length)return this.$set(this.fGens,s,[Object.assign({},this.dFGen)]),void this.$nextTick(this.validateInputs);for(var o=0;o<this.fGens[s].length;o++){var r=this.fGens[s][o].sType;for(n=0;n<this.cLang.fGens.sTypes[r].params.length;n++){var d=this.cLang.fGens.sTypes[r].params[n];if(void 0===this.fGens[s][o].params[d])return this.$set(this.fGens[s][o].params,d,Object.assign({},this.cLang.fGens.params[d])),void this.$nextTick(this.validateInputs)}var l=Object.keys(this.fGens[s][o].params);for(n=0;n<l.length;n++)if(this.cLang.fGens.sTypes[r].params.indexOf(l[n])<0)return this.$delete(this.fGens[s][o].params,l[n]),void this.$nextTick(this.validateInputs)}}}}}});MathJax.Hub.Config({showMathMenu:!1,messageStyle:"none",menuSettings:{inTabOrder:!1},extensions:["tex2jax.js"],jax:["input/TeX","output/HTML-CSS"],tex2jax:{preview:"none",inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]}}),google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){var e=new google.visualization.LineChart(document.getElementById("chart_div")),a=new google.visualization.DataTable;app.$set(app.$data.chart,"view",e),app.$set(app.$data.chart,"data",a),app.$set(app.$data.chart,"options",{fontName:"'Computer Modern Serif',sans-serif",legend:"none",chartArea:{right:25,top:25,left:75,bottom:25},explorer:{actions:["dragToZoom","rightClickToReset"]},backgroundColor:{fill:"transparent"}}),app.$set(app.$data.chart,"ready",!0),app.resetChart()}),new ResizeSensor(document.getElementById("chart_parent"),function(){app.$data.chart.uCounter++});